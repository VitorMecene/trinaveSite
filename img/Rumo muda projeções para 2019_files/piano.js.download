'use strict';window.addEventListener("message",function(e){if(e.data.action=='showOffer'||e.data.action=='forceOffer'||e.data.action=='forceLogin'||e.data.action=='LoginInit'||e.data.action=='custom'||e.data.action=='LoginFacebookSuccess'||e.data.action=='LoginSuccess'||e.data.action=='CheckoutInitPaywallClick'||e.data.action=='CheckoutTesteABClick'||e.data.action=='CheckoutFacebookLoginSuccess'||e.data.action=='CheckoutLoginSuccess'||e.data.action=='CheckoutPadraoLoginSuccess'||e.data.action=='CheckoutCadastroSuccess'||e.data.action=='CheckoutPadraoCadastroSuccess'||e.data.action=='CheckoutPagamentoSuccess'||e.data.action=='CheckoutPadraoPagamentoSuccess'||e.data.action=='showLeadIn'||e.data.action=='bloqueioLeituraPianoID'||e.data.action=='avisoLeituraPianoID'||e.data.action=='showPlanosLeadin'){console.log('QALOG');console.log(e.data);}});if(typeof piano_is_sandbox_or_product==='undefined'){var piano_is_sandbox_or_product="production";}else{piano_is_sandbox_or_product=piano_is_sandbox_or_product.toString();}
if(typeof label_piano_analytics==='undefined'){var label_piano_analytics="";}else{label_piano_analytics=label_piano_analytics.toString();}
if(typeof id_piano_analytics==='undefined'){var id_piano_analytics="";}else{id_piano_analytics=id_piano_analytics.toString();}
if(typeof piano_brand==='undefined'){var piano_brand="";}else{piano_brand=piano_brand.toString();}
function htmlDecode(input){var doc=new DOMParser().parseFromString(input,"text/html");return doc.documentElement.textContent;}
function validateEmail(email){var re=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return re.test(email);}
function validateName(name){var re=/^[A-Za-záàâãéèêíïóôõöúçñÁÀÂÃÉÈÍÏÓÔÕÖÚÇÑ' ]+$/;return re.test(name);}
function getHashUserRef(callback){var abrilUserCryptHash=getAbrUserCrypt();if(callback){var c_name="TPUserRef";var cookie=getCookie(c_name);if(cookie){callback(cookie);}
else{var d=new Date();d.setTime(d.getTime()+(5*60*1000));var expires="expires="+d.toUTCString();var xhttp=new XMLHttpRequest();xhttp.onreadystatechange=function(){if(xhttp.readyState==4&&xhttp.status==200){var data=JSON.parse(xhttp.responseText);var token=data.message;document.cookie=c_name+"="+data.message+";"+expires+";domain=.abril.com.br;path=/";callback(token);}}
var date=new Date();var timestamp=date.getTime();var middleware_env="&env="+piano_is_sandbox_or_product;var uri=encodeURI("https://authp.abril.com.br/setUserRef.php?"+middleware_env+"&nocache="+timestamp);var par=encodeURI("abrilUserCryptHash="+abrilUserCryptHash);xhttp.open("POST",uri,true);xhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");xhttp.send(par);}}}
function syncPianoAssine(callback){var abrilUserCryptHash=getAbrUserCrypt();if(callback){var c_name="CheckSyncPiano";var cookie=getCookie(c_name);if(cookie){callback();}else{var d=new Date();d.setTime(d.getTime()+(1*24*60*60*1000));var expires="expires="+d.toUTCString();var m=new Date();m.setTime(m.getTime()+(365*24*60*60*1000));var expiresM="expires="+m.toUTCString();var xhttp=new XMLHttpRequest();xhttp.onreadystatechange=function(){if(xhttp.readyState==4&&xhttp.status==200){var data=JSON.parse(xhttp.responseText);if(typeof data.firstName!=='undefined'){var firstName=data.firstName.split(" ");firstName=firstName[0].toLowerCase();firstName=firstName.charAt(0).toUpperCase()+firstName.slice(1);document.cookie=c_name+"="+data.message+";"+expires+";domain=.abril.com.br;path=/";document.cookie="userIdMetricGA"+"="+data.fullName+";"+expires+";domain=.abril.com.br;path=/";document.cookie="userAbrilLogged"+"="+firstName+";"+expiresM+";domain=.abril.com.br;path=/";}
callback();}}
var date=new Date();var timestamp=date.getTime();var middleware_env="&env="+piano_is_sandbox_or_product;var uri=encodeURI("https://authp.abril.com.br/syncPianoAssine.php?"+middleware_env+"&nocache="+timestamp);var par=encodeURI('abrilUserCryptHash='+abrilUserCryptHash);xhttp.open("POST",uri,true);xhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");xhttp.send(par);}}}
function setUserHashAnalytics(){var c_name="userHashAnalytics";var cookie=getCookie(c_name);if(!cookie){var d=new Date();d.setTime(d.getTime()+(1*24*60*60*1000));var expires="expires="+d.toUTCString();var request=$.ajax({url:"https://authp.abril.com.br/setUserHashAnalytics.php",method:"POST",async:true,complete:function(data){document.cookie=c_name+"="+data.responseText+";"+expires+";domain=.abril.com.br;path=/";},data:{env:piano_is_sandbox_or_product,abrilUserCryptHash:getAbrUserCrypt()}});}}
function getCookie(cname,cpar){var name=cname+"=";var ca=document.cookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==' '){c=c.substring(1);}
if(c.indexOf(name)==0&&cpar==undefined){return c.substring(name.length,c.length);}
if(c.indexOf(name)==0&&cpar){var arr=[];str=c.substring(name.length,c.length);str=str.split(":");for(var j=0;j<str.length;j++){a=str[j].split("=");arr[a[0]]=a[1];}
if(arr[cpar]){return arr[cpar];}}}
return"";}
function setCookie(cname,value,date){var expires='';if(date){var d=date;expires="expires="+d.toUTCString();}
document.cookie=cname+"="+value+";"+expires+";domain=.abril.com.br;path=/";}
function deleteCookie(cname){var	d=new Date();d.setTime(d.getTime()-1);setCookie(cname,'false',d);}
function logoutPaywall(){document.cookie='AbrilUser=; expires=Thu, 01 Jan 1970 00:00:01 GMT;domain=.abril.com.br;path=/';document.cookie='TPUserRef=; expires=Thu, 01 Jan 1970 00:00:01 GMT;domain=.abril.com.br;path=/';document.cookie='CheckSyncPiano=; expires=Thu, 01 Jan 1970 00:00:01 GMT;domain=.abril.com.br;path=/';document.cookie='userAbrilLogged=; expires=Thu, 01 Jan 1970 00:00:01 GMT;domain=.abril.com.br;path=/';location.reload();}
function resetSyncCookie(){document.cookie='CheckSyncPiano=; expires=Thu, 01 Jan 1970 00:00:01 GMT;domain=.abril.com.br;path=/';location.reload();}
function getAbrUserCrypt(){return getCookie('AbrilUser');}
function printScriptTP(piano_env,piano_aid){var div=$('<div></div>');div
.attr('id','piano_offer')
.css('width','100%')
.hide()
.appendTo('BODY');(function(src){var a=document.createElement("script");a.type="text/javascript";a.async=true;a.src=src;var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)})("//"+piano_env+".tinypass.com/xbuilder/experience/load?aid="+piano_aid);}
var thisOffer=false;function setOfferParams(event){thisOffer={templateId:event.templateId,offerId:event.offerId}}
function showOffer(){if(tp&&thisOffer){tp.offer.show(thisOffer);}}
if(typeof ga==='undefined'){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');}
ga('create',id_piano_analytics,{'name':'ga'+piano_brand,'cookieName':'_ga'+piano_brand,'cookieDomain':'abril.com.br',});function setCookieSignwall(brand_slug){var year=new Date();year.setTime(year.getTime()+(12*24*60*60*1000));var expires="expires="+year.toUTCString();document.cookie="_pc_"+brand_slug+"_signwall=true;"+expires+";domain=.abril.com.br;path=/";location.reload();}
var eventLabel=label_piano_analytics;window.addEventListener("message",function(e){if(e.data.action==='LoginSuccess'||e.data.action==='LoginFacebookSuccess'||e.data.action==='CheckoutPagamentoSuccess'){if(e.data.asi_piano){var d='';d=new Date();d.setTime(d.getTime()+(30*24*60*60*1000));setCookie('AbrilUser',e.data.asi_piano,d);}}
switch(e.data.action){case'setEventLabel':if(typeof e.data.eventLabel!="undefined"&&e.data.eventLabel!=''){eventLabel=e.data.eventLabel+' - '+eventLabel;}
break;case'createCookie':var d='';d=new Date();d.setTime(d.getTime()+(9*60*1000));var nine_minutes=d;d.setTime(d.getTime()+(30*24*60*60*1000));var one_month=d;setCookie('TPUserRef',e.data.userRef,nine_minutes);setCookie('AbrilUser',e.data.crypt,one_month);setUserHashAnalytics();tp.offer.close();break;case'showOffer':if(typeof e.data.eventLabel!="undefined"&&e.data.eventLabel!=""){eventLabel=e.data.eventLabel;}
$('#piano_offer').removeAttr('style');$('#piano_offer').show();$('#piano_offer DIV').show();$('BODY').css('padding','0px');var pianoOfferOverlay=$('<div />').attr({'class':'piano-offer-overlay'});$(pianoOfferOverlay).insertBefore("#piano_offer");var screenWidth=$(window).width();var screenHeight=$(window).height();$('.piano-offer-overlay').css('top',$(window).scrollTop()).css('width',screenWidth);$('.piano-offer-overlay').height(screenHeight);if(window.document.body.clientWidth<991){document.querySelector('#piano_offer').style.width='100%'
document.querySelector('#piano_offer').style.height='100vh'
document.querySelector('#piano_offer').style.overflow='scroll'}
ga('set','metric1',1);ga('ga'+piano_brand+'.send',{hitType:'event',eventCategory:'Paywall',eventAction:'Bloqueio de Leitura',eventLabel:eventLabel});break;case'forceOffer':ga('set','metric9',1);ga('ga'+piano_brand+'.send',{hitType:'event',eventCategory:'Paywall',eventAction:e.data.eventAction,eventLabel:e.data.eventLabel});var url=window.location.href+'?paywall=offer';setTimeout(function(){window.location.href=url},1500);break;case'forceLogin':ga('set','metric10',1);ga('ga'+piano_brand+'.send',{hitType:'event',eventCategory:'Paywall',eventAction:e.data.eventAction,eventLabel:e.data.eventLabel});var url=window.location.href;if(url.indexOf('utm_source=paywall')!==-1){url=url.replace('utm_source=paywall','paywall=access');}else if(url.indexOf('?')!==-1){url=url+'&paywall=access';}else{url=url+'?paywall=access';}
setTimeout(function(){window.location.href=url},1500);break;case'LoginInit':ga('set','metric11',1);ga('ga'+piano_brand+'.send',{hitType:'event',eventCategory:'Paywall',eventAction:'Entrada no fluxo de Login',eventLabel:eventLabel});break;case'logoutPaywall':logoutPaywall();break;case'custom':ga('set','metric12',1);ga('ga'+piano_brand+'.send',{hitType:'event',eventCategory:e.data.eventCategory,eventAction:e.data.eventAction,eventLabel:e.data.eventLabel});break;case'resetSyncCookie':resetSyncCookie();break;case'close':tp.offer.close();break;case'LoginFacebookSuccess':case'LoginSuccess':ga('set','metric2',1);ga('ga'+piano_brand+'.send',{hitType:'event',eventCategory:'Paywall',eventAction:'Login Efetuado',eventLabel:eventLabel});break;case'CheckoutInitPaywallClick':ga('set','metric3',1);ga('ga'+piano_brand+'.send',{hitType:'event',eventCategory:'Paywall',eventAction:'Entrada no Fluxo de Pagamento',eventLabel:eventLabel});break;case'CheckoutTesteABClick':ga('set','metric4',1);ga('ga'+piano_brand+'.send',{hitType:'event',eventCategory:'Paywall',eventAction:'Avanço Exibição de Preço A/B',eventLabel:eventLabel});break;case'CheckoutFacebookLoginSuccess':case'CheckoutLoginSuccess':case'CheckoutPadraoLoginSuccess':ga('set','metric5',1);ga('ga'+piano_brand+'.send',{hitType:'event',eventCategory:'Paywall',eventAction:'Login via fluxo de pagamento',eventLabel:eventLabel});break;case'CheckoutCadastroSuccess':case'CheckoutPadraoCadastroSuccess':ga('set','metric6',1);ga('ga'+piano_brand+'.send',{hitType:'event',eventCategory:'Paywall',eventAction:'Cadastro Efetuado',eventLabel:eventLabel});break;case'CheckoutPagamentoSuccess':case'CheckoutPadraoPagamentoSuccess':ga('set','metric7',1);ga('ga'+piano_brand+'.send',{hitType:'event',eventCategory:'Paywall',eventAction:'Pagamento Efetuado',eventLabel:eventLabel});break;case'showLeadIn':ga('set','metric8',1);ga('ga'+piano_brand+'.send',{hitType:'event',eventCategory:'Paywall',eventAction:'Bloqueio Lead In',eventLabel:eventLabel});break;case'signwallLoginOk':var xhttp=new XMLHttpRequest();xhttp.onreadystatechange=function(){if(xhttp.readyState==4){var data=JSON.parse(xhttp.responseText);if(data.status){setCookieSignwall(e.data.brand);}}}
var date=new Date();var timestamp=date.getTime();var middleware_env="&env="+piano_is_sandbox_or_product;var uri=encodeURI("https://authp.abril.com.br/createUserSignwall.php?"+middleware_env+"&nocache="+timestamp);var par=encodeURI("abrilUserFirstName="+e.data.firstname+"&abrilUserLastName="+e.data.lastname+"&abrilUserEmail="+e.data.email+"&abrilUserTermId="+e.data.resource_id);xhttp.open("POST",uri,true);xhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");xhttp.send(par);break;case'signwallAuthorizedOk':tp.api.callApi("/conversion/registration/create",{term_id:e.data.term_id},function(conversionData){tp.user.refreshAccessToken(true,function(accessTokenList){setCookieSignwall(e.data.brand);});});break;case'createCookieSignwall':setCookieSignwall(e.data.brand);break;case'bloqueioLeituraPianoID':ga('set','metric1',1);ga('ga'+piano_brand+'.send',{hitType:'event',eventCategory:'Signwall',eventAction:'Bloqueio de Leitura',eventLabel:eventLabel});break;case'avisoLeituraPianoID':ga('set','metric2',1);ga('ga'+piano_brand+'.send',{hitType:'event',eventCategory:'Signwall',eventAction:'Aviso de Leitura',eventLabel:eventLabel});break;case'closePaywallNotice':$('.paywall-notice').fadeOut();break;case'resizePaywallModal':if(typeof newModal=='undefined'){$('#piano_offer').css('top','0').css('left','0');$('#piano_offer').css('width','100%').css('height','100%');}
break;case'closePaywallModal':if(window.location.href.indexOf('/assinatura/')!==-1){window.location.href=window.location.origin;}
$('#piano_offer').css('display','none');$('.piano-offer-overlay').css('display','none');$('body').attr('style','');break;case'modalToFullscreen':$('#piano_offer').addClass('fullscreen');break;case'showPlanosLeadin':var offerID=e.data.offerID;var templateID=e.data.templateID;tp.offer.show({offerId:offerID,templateId:templateID,displayMode:"inline",containerSelector:"#piano_offer"});ga('set','metric13',1);ga('ga'+piano_brand+'.send',{hitType:'event',eventCategory:'Paywall',eventAction:'Tela com mais opções de assinaturas',eventLabel:eventLabel});break;case'sendArticleDetails':var title=document.querySelector('h1').innerHTML;var subtitle=document.querySelector('h2').innerHTML;var cleanTitle=htmlDecode(title);var cleanSubtitle=htmlDecode(subtitle);cleanTitle=cleanTitle.replace(/<\/?[^>]+(>|$)/g,"");cleanSubtitle=cleanSubtitle.replace(/<\/?[^>]+(>|$)/g,"");var obj={action:'testing',title:cleanTitle,subtitle:cleanSubtitle}
document.querySelector('#piano_offer iframe').contentWindow.window.postMessage(obj,'*');break;case'goToHome':window.location=window.location.origin+'/?utm_source=paywall';break;}
if(e.data.action=='LoginInit'||e.data.action=='LoginSuccess'||e.data.action=='LoginFail'||e.data.action=='LoginFacebookSuccess'||e.data.action=='LoginFacebookFail'||e.data.action=='CheckoutLoginSuccess'||e.data.action=='CheckoutLoginFail'||e.data.action=='CheckoutFacebookLoginSuccess'||e.data.action=='CheckoutFacebookLoginFail'||e.data.action=='CheckoutCadastroSuccess'||e.data.action=='CheckoutCadastroFail'||e.data.action=='CheckoutPagamentoSuccess'||e.data.action=='CheckoutPagamentoFail'||e.data.action=='CheckoutPadraoInit'||e.data.action=='CheckoutPadraoCarrinho'||e.data.action=='CheckoutPadraoPopOffer'||e.data.action=='CheckoutPadraoLoginInit'||e.data.action=='CheckoutPadraoCadastroInit'||e.data.action=='CheckoutPadraoLoginSuccess'||e.data.action=='CheckoutPadraoLoginFail'||e.data.action=='CheckoutPadraoCadastroSuccess'||e.data.action=='CheckoutPadraoCadastroFail'||e.data.action=='CheckoutPadraoAddress'||e.data.action=='CheckoutPadraoPagamentoInit'||e.data.action=='CheckoutPadraoPopPromotion'||e.data.action=='CheckoutPadraoPagamentoSuccess'||e.data.action=='CheckoutPadraoPagamentoFail'||e.data.action=='CheckoutPadraoSiteBack'){window.scrollTo(0,0);}},false);var views=0;var maxViews=0;function pushCustomVariablesofView(meterData){views=meterData.views;maxViews=meterData.maxViews;tp=window["tp"]||[];tp.push(["setCustomVariable","views",meterData.views]);tp.push(["setCustomVariable","maxViews",meterData.maxViews]);}
function startPiano(env,aid){if(getAbrUserCrypt()){syncPianoAssine(function(){getHashUserRef(function(token){tp.push(["setUserRef",getCookie("TPUserRef")]);printScriptTP(env,aid);});});}else{printScriptTP(env,aid);}}
function actionLeadIn(label){try{document.getElementsByClassName('content-image alignleft wp-caption')[0].style.display='none';}catch(e){}
try{abrAd.remove();}catch(e){}
$('#assine-ja').on('click',function(e){e.preventDefault();showOffer(label);});}
function showOffer(label){const label_param=label||'';var re=/([A|a]n[o|ô]nim[a|o])/;var check_private_window=label_param.match(re);if('undefined'!==typeof(wp_piano_vars)){var brand=window.location.hostname.split(".").splice(-4,1).join(".");var dc_seg="";if(wp_piano_vars.tipo_paywall==="closed"&&check_private_window===null){switch(brand){case'super':dc_seg=587728358;break;case'veja':dc_seg=587728283;break;case'exame':dc_seg=588207259;break;case'quatrorodas':dc_seg=587728289;break;}
}else if(wp_piano_vars.tipo_paywall==="accounted"&&check_private_window===null){switch(brand){case'super':dc_seg=588207004;break;case'veja':dc_seg=588206941;break;case'exame':dc_seg=587702240;break;case'quatrorodas':dc_seg=587715383;break;}}
if(dc_seg!==""){var axel=Math.random()+'';var a=axel*10000000000000;var dfp_img=document.createElement("img");dfp_img.setAttribute("src",'https://pubads.g.doubleclick.net/activity;dc_iu=/9287/DFPAudiencePixel;ord='+a+';dc_seg='+dc_seg+'?');dfp_img.setAttribute("width",1);dfp_img.setAttribute("height",1);dfp_img.setAttribute("border",0);document.getElementById("piano_offer").appendChild(dfp_img);}}
var obj;if(typeof label=="undefined"){obj={action:'showOffer'}}else{obj={action:'showOffer',eventLabel:label}}
window.top.postMessage(obj,"*");try{abrAd.remove();}catch(e){}
$('body').attr('style','overflow:hidden !important');$('body').css('margin-top','0px');var removeNewsletter=setInterval(function(){var teaser=$('div[id*="teaser"]');if(teaser.length){clearInterval(removeNewsletter);}
teaser.hide().remove().css({'display':'none'});},1000);}
function closeLeadIn(){if($('#closed-article').length){var closedArticle=document.querySelectorAll('section #closed-article');var specialContentBlocked=document.getElementsByClassName('content-blocked');document.getElementById('closed-article').removeAttribute("id");document.getElementsByClassName('box-article-blocked')[0].style.display='none';document.querySelector('.special-post-main-container .content-closed').removeAttribute("class");for(i=0;i<closedArticle.length;i++){closedArticle[i].removeAttribute("id");}
if(document.getElementsByClassName('special-post-main-container').length){for(var i=0;i<specialContentBlocked.length;i++){document.getElementsByClassName('content-blocked')[i].style.height='auto';document.getElementsByClassName('content-blocked')[i].style.display='block';}}}else if($('.content-blocked').length){var getElements=document.getElementsByClassName('content-blocked');for(var i=0;i<getElements.length;i++){document.getElementsByClassName('content-blocked')[i].style.height='auto';document.getElementsByClassName('content-blocked')[i].style.display='block';}
document.getElementsByClassName('mask-blocked')[0].style.display='none';}else if($('#closed-video').length){document.getElementsByClassName('box-article-blocked')[0].style.display='none';document.getElementById('closed-video').removeAttribute("id");document.getElementsByClassName('out')[0].style.display='none';document.getElementsByClassName('callpaywall')[1].style.display='none';}else if($('.fit-video').length){document.getElementsByClassName('out')[0].style.display='none';}
document.getElementsByClassName('callpaywall')[0].style.display='none';}
function showLazyLoaded(){if($('.lazyloaded').length){var getElementLazyloaded=document.getElementsByClassName('lazyloaded');for(var i=0;i<getElementLazyloaded.length;i++){document.getElementsByClassName('lazyloaded')[i].style.display='block';}}}
function fixPaywallNotice(){if($(window).width()>991){$('.paywall-notice').css({'margin-bottom':'30px'});}}
function showPaywallNotice(){$('.paywall-notice').fadeIn();}